<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    

    <title>Multi-Taxi Path with Mapbox</title>
    <link
      href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css"
      rel="stylesheet"
    />
    <link
      href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.1/mapbox-gl-directions.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      integrity="sha512-..."
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./css/clientStyle.css" />
    <link rel="stylesheet" href="./css/popup.css" />
  </head>
  <body>
    <div class="wrapper">
      <!-- Top navigation bar -->
      <nav class="topnav">
        <div class="nav-container">
          <div class="logo">
            <a href="Home.html">
              <img src="./images/Add a subheading (1).png" alt="Logo" />
            </a>
          </div>

          <!-- Burger button for mobile -->
          <div class="burger" onclick="toggleMobileMenu()">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
          </div>

          <!-- Navigation links -->
          <div class="nav-links" id="mobileMenu">
            <a href="client.html">Find route</a>
            <a href="clientCrowdSource.html">Suggest route</a>
            <a href="#help">Help</a>
          </div>
        </div>
      </nav>
      <!-- Search slider button-->
      
      <!-- Popup -->
      <div id="popup-container"></div>
       
       
      <div class="page-content">

        <button class="searchSlider">
        <i class="fa-solid fa-caret-down"  style="color: #919191; font-size: 20px"    aria-hidden="true"></i>
       </button>

        <div class="search_container">
            <div class="sourceSearch container">
              <div class="searchRow source">
                <i
                  class="fas fa-search"
                  style="color: #919191; font-size: 20px"
                ></i>
                <input
                  class="search_input source"
                  placeholder="Search Starting location"
                />
              </div>

              <ul class="searchList listSource"></ul>
            </div>
            <div class="destinationSearch container">
              <div class="searchRow dest">
                <i
                  class="fas fa-search"
                  style="color: #919191; font-size: 20px"
                ></i>
                <input
                  class="search_input destination"
                  placeholder="Search Destination"
                />
              </div>
              <ul class="searchList listDestination"></ul>
            </div>
          </div>

        <!--Ui section-->
        <div id="ui_container">
          <!--Search-->
         
          <!-- From and To buttons -->
          <div class="toggleButtons_container">
            <button class="toggleBtn from">From</button>
            <button class="toggleBtn to">To</button>
          </div>

          <!-- Toggle button -->

          <div class="toggle-container">
            <span class="toggle-label price-off"></span>
            <div class="toggle-button" id="toggle">
              <div class="toggle-circle"></div>
            </div>
            <span class="toggle-label price-on">See Price devision</span>
          </div>

          <!--Route list-->
          <div class="routeList_container">
            <div class="cover price">
              <p>Price</p>
            </div>

            <div class="list_container">
              <div class="listSub_container list_right">
                <ul>
                  <li class="rightPriceRow"><div class="route_circle"></div>Route 1</li>
                </ul>
              </div>
              <div class="listSub_container list_left">
                <ul>
                  <li class="leftPriceRow">R50.00</li>
                </ul>
              </div>
            </div>

            <div class="cover total_price">
              <p>Total:</p>
              <p>R0.00</p>
            </div>
          </div>

          <!--Directions -->
          <div class="direction_container">
            <p>Directions :</p>
            <button class="default_direction_button">Default</button>
            <div class="sub_direction_container">
              <!-- <button class="direction_button">DA</button>
              <button class="direction_button">DA</button>
              <button class="direction_button">DA</button>
              <button class="direction_button">DA</button>
              <button class="direction_button">DA</button>
              <button class="direction_button">DA</button>
              <button class="direction_button">DA</button>
              <button class="direction_button">DA</button>
              <button class="direction_button">DA</button> -->
            </div>
          </div>

          <button class="feedbackBtn">Feedback</button>
        </div>
        <!--Context menu-->
        <div class="menu markerConfirmation">
          <p id="title">Marker Confirmation</p>
          <button class="close_button" id="del_close_button">
            <i
              class="fa fa-times"
              style="font-size: 20px; color: rblackd"
              aria-hidden="true"
            ></i>
          </button>
          <div class="markerInformation">
            <p>Do you want to lock-in this location ?</p>
          </div>
          <div class="btnContainer">
            <button class="btn no">No</button>
            <button class="btn yes">Yes</button>
          </div>
        </div>

        <!-- Cancel Context menu -->
        <div class="menu cancelRoute">
          <p id="title">Cancel Route</p>
          <button class="close_button" id="del_close_button">
            <i
              class="fa fa-times"
              style="font-size: 20px; color: rblackd"
              aria-hidden="true"
            ></i>
          </button>
          <div class="Information">
            <p>Do you want to cancel the current route ?</p>
          </div>
          <div class="btnContainer">
            <button class="btn no">No</button>
            <button class="btn yes">Yes</button>
          </div>
        </div>

        <!--Map-->
        <div class="map_container">
          <div id="toggleBtn" class="circle-button">
            <div class="arrow"></div>
          </div>

          <!-- <div id="text-map">
           <div style="color: red;">ER Start</div>
           <div style="color: #F0F4F7;">>> Midpoint</div>
           <div style="color: #00CED1;">ðŸ›‘ End</div>
          </div> -->

          <div id="map">
            <!--area filter -->
            <div class="areaContainer">
              <p>Highlight clickable radius</p>

              <!-- toggle button -->
              <div class="toggle-container">
                <div class="area toggle-button" id="areatoggle">
                  <div class="area toggle-circle"></div>
                </div>
              </div>
            </div>

            <!--Location indicatiion Markers-->
            <div class="locationsContainer">
              <div class="sourceLocation">
                <i
                  class="fa-solid fa-location-dot sourcePin"
                  style="font-size: 25px; color: #919191"
                ></i>
                <p>Starting</p>
              </div>

              <div class="destLocation">
                <i
                  class="fa-solid fa-location-dot destPin"
                  style="font-size: 25px; color: #919191"
                ></i>
                <p>Ending</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Load popup -->
    <script>

      //popup
      fetch("popup.html")
        .then((res) => res.text())
        .then((html) => {
          document.getElementById("popup-container").innerHTML = html;
        });



        
       function toggleMobileMenu() {
    const menu = document.getElementById("mobileMenu");
    menu.classList.toggle("show");
  }


  //slide 
  function attachSearchToggle() {
    searchSliderBtn = document.querySelector(".searchSlider");
    const searchContainer = document.querySelector(".search_container");

    if (searchSliderBtn && !searchSliderBtn.dataset.bound) {
      searchSliderBtn.addEventListener("click", () => {
        searchContainer.classList.toggle("hidden");
      });
      searchSliderBtn.dataset.bound = "true"; // Prevent duplicate bindings
    }
  }

  //moving search container 
  function moveSearchContainer() {
    const search = document.getElementById("search_container");
    const ui = document.getElementById("ui_container");

    if (window.innerWidth > 768) {
      // Desktop: insert search_container back into ui_container
      if (!ui.contains(search)) {
        ui.insertBefore(search, ui.firstChild); // insert at top of ui_container
      }
    } else {
      // Mobile: move it out of ui_container to body (or wrapper)
      if (ui.contains(search)) {
        document.body.insertBefore(search, ui);
      }
    }
  }

  //fix textmap

  function textMapHeightAdj(){
      if (window.innerWidth <= 768) {
 const navbar = document.querySelector('.topnav');
const textmap = document.querySelector('#text-map ');
 const height = navbar.offsetHeight;
  textmap.style.top = `${height +40}px`;
      }
  }

  // Run once on load
  document.addEventListener("DOMContentLoaded", () => {
    attachSearchToggle();
    moveSearchContainer();
  });

  // Re-attach on window resize (for dynamic appearance of .searchSlider)
  window.addEventListener("resize", () => {
     moveSearchContainer();
    if (window.innerWidth <= 768) {
      attachSearchToggle();
      textMapHeightAdj()
    }
});
    </script>

    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.1/mapbox-gl-directions.js"></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsts@2.11.0/dist/jsts.min.js"></script>
    <script type="module" src="./js/client.js"></script>
  </body>
</html>
