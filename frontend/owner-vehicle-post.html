<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Your Vehicle | TeksiMap</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="./favicon.svg">
    <link rel="icon" type="image/svg+xml" href="./favicon-16x16.svg" sizes="16x16">
    <link rel="icon" type="image/svg+xml" href="./favicon-32x32.svg" sizes="32x32">
    <link rel="apple-touch-icon" href="./apple-touch-icon.svg">
    <link rel="manifest" href="./site.webmanifest">
    
    <!-- CSS -->
    <link rel="stylesheet" href="./css/clientStyle.css">
    <link rel="stylesheet" href="./css/booking.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css">
    
    <style>
        .vehicle-post-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
        }
        
        .post-content {
            max-width: 100%;
            margin: 0 auto;
        }
        
        body {
            margin: 0;
            padding: 0;
        }
        
        html {
            height: 100%;
        }
        
        .post-header {
            background: linear-gradient(135deg, #01386A 0%, #025aa5 100%);
            color: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            text-align: center;
            box-shadow: 0 8px 32px rgba(1, 56, 106, 0.3);
        }
        
        .post-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .post-subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .post-form {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .form-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            background: #f8f9fa;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #01386A;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }
        
        .form-input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #01386A;
            box-shadow: 0 0 0 3px rgba(1, 56, 106, 0.1);
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .form-select {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
        }
        
        .form-select:focus {
            outline: none;
            border-color: #01386A;
            box-shadow: 0 0 0 3px rgba(1, 56, 106, 0.1);
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: white;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .checkbox-item:hover {
            border-color: #01386A;
            background: #f8f9fa;
        }
        
        .checkbox-item input[type="checkbox"] {
            margin: 0;
        }
        
        .coverage-map-container {
            height: 400px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #e9ecef;
            margin-top: 1rem;
        }
        
        .rate-input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .rate-input-group .form-input {
            flex: 1;
        }
        
        .rate-suffix {
            color: #6c757d;
            font-weight: 600;
        }
        
        .image-upload-area, .video-upload-area {
            border: 2px dashed #01386A;
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .image-upload-area:hover, .video-upload-area:hover {
            background: #e9ecef;
            border-color: #025aa5;
        }
        
        .image-upload-area.dragover, .video-upload-area.dragover {
            background: #e3f2fd;
            border-color: #1976d2;
        }
        
        .main-image-upload {
            border-color: #28a745;
            background: #f8fff8;
        }
        
        .main-image-upload:hover {
            background: #e8f5e8;
            border-color: #20c997;
        }
        
        .upload-icon {
            font-size: 3rem;
            color: #01386A;
            margin-bottom: 1rem;
        }
        
        .upload-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }
        
        .upload-hint {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .image-preview, .main-image-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .main-image-preview {
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        }
        
        .preview-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .preview-item img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }
        
        .main-image-preview .preview-item img {
            height: 150px;
        }
        
        .preview-remove {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .video-preview {
            margin-top: 1rem;
        }
        
        .video-preview-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 300px;
        }
        
        .video-preview-item video {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .video-info {
            padding: 1rem;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }
        
        .video-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.3rem;
        }
        
        .video-size {
            font-size: 0.8rem;
            color: #6c757d;
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }
        
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #01386A 0%, #025aa5 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(1, 56, 106, 0.3);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-1px);
        }
        
        .progress-indicator {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e9ecef;
            color: #6c757d;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-bottom: 0.5rem;
            transition: all 0.3s ease;
        }
        
        .progress-step.active .step-number {
            background: linear-gradient(135deg, #01386A 0%, #025aa5 100%);
            color: white;
        }
        
        .progress-step.completed .step-number {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }
        
        .step-label {
            font-size: 0.9rem;
            color: #6c757d;
            text-align: center;
        }
        
        .progress-line {
            width: 80px;
            height: 2px;
            background: #e9ecef;
            margin: 0 1rem;
            margin-top: -20px;
        }
        
        .progress-line.completed {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        @media (max-width: 768px) {
            .vehicle-post-container {
                padding: 1rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="vehicle-post-container">
        <div class="post-content">
            <!-- Header -->
            <div class="post-header">
                <h1 class="post-title">
                    <i class="fas fa-car"></i>
                    Post Your Vehicle
                </h1>
                <p class="post-subtitle">List your taxi or bus on TeksiMap and start earning</p>
            </div>

        <!-- Progress Indicator -->
        <div class="progress-indicator">
            <div class="progress-step completed">
                <div class="step-number">âœ“</div>
                <div class="step-label">Vehicle Info</div>
            </div>
            <div class="progress-line completed"></div>
            <div class="progress-step active">
                <div class="step-number">2</div>
                <div class="step-label">Coverage Areas</div>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step">
                <div class="step-number">3</div>
                <div class="step-label">Review & Publish</div>
            </div>
        </div>

        <!-- Vehicle Posting Form -->
        <form id="vehiclePostForm" class="post-form">
            <!-- Vehicle Information Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-car"></i>
                    Vehicle Information
                </h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="vehicleName">Vehicle Name *</label>
                        <input type="text" id="vehicleName" class="form-input" placeholder="e.g., Golden Arrow Minibus" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="vehicleType">Vehicle Type *</label>
                        <select id="vehicleType" class="form-select" required>
                            <option value="">Select vehicle type</option>
                            <option value="minibus">Minibus Taxi (16-18 seats)</option>
                            <option value="bus">22-Seater Bus</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="registration">Registration Number *</label>
                        <input type="text" id="registration" class="form-input" placeholder="e.g., CA 123-456" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="capacity">Seating Capacity *</label>
                        <input type="number" id="capacity" class="form-input" placeholder="16" min="1" max="50" required>
                    </div>
                </div>
            </div>

            <!-- Pricing Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-dollar-sign"></i>
                    Pricing & Rates
                </h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="ratePerKm">Rate per Kilometer *</label>
                        <div class="rate-input-group">
                            <span>R</span>
                            <input type="number" id="ratePerKm" class="form-input" placeholder="15.50" step="0.01" min="0" required>
                            <span class="rate-suffix">/km</span>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="minimumFare">Minimum Fare</label>
                        <div class="rate-input-group">
                            <span>R</span>
                            <input type="number" id="minimumFare" class="form-input" placeholder="50.00" step="0.01" min="0">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Amenities Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-star"></i>
                    Amenities & Features
                </h3>
                
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="ac" value="AC">
                        <label for="ac">Air Conditioning</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="music" value="Music">
                        <label for="music">Music System</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="wifi" value="WiFi">
                        <label for="wifi">WiFi</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="charging" value="Charging Ports">
                        <label for="charging">Charging Ports</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="luggage" value="Luggage Space">
                        <label for="luggage">Luggage Space</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="wheelchair" value="Wheelchair Accessible">
                        <label for="wheelchair">Wheelchair Accessible</label>
                    </div>
                </div>
            </div>

            <!-- Coverage Areas Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-map-marked-alt"></i>
                    Coverage Areas
                </h3>
                
                <div class="form-group">
                    <label class="form-label">Select Areas You're Willing to Travel To *</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="jhb_cbd" value="Johannesburg CBD">
                            <label for="jhb_cbd">Johannesburg CBD</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="soweto" value="Soweto">
                            <label for="soweto">Soweto</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sandton" value="Sandton">
                            <label for="sandton">Sandton</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="pretoria" value="Pretoria">
                            <label for="pretoria">Pretoria</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="centurion" value="Centurion">
                            <label for="centurion">Centurion</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="midrand" value="Midrand">
                            <label for="midrand">Midrand</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="randburg" value="Randburg">
                            <label for="randburg">Randburg</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="roodepoort" value="Roodepoort">
                            <label for="roodepoort">Roodepoort</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="maxDistance">Maximum Travel Distance (km)</label>
                    <input type="number" id="maxDistance" class="form-input" placeholder="50" min="1" max="200" value="50">
                </div>
                
                <div class="coverage-map-container" id="coverageMap">
                    <!-- Map will be initialized here -->
                </div>
            </div>

            <!-- Vehicle Images Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-images"></i>
                    Vehicle Images & Videos
                </h3>
                
                <!-- Main Image Upload -->
                <div class="form-group">
                    <label class="form-label">Main Image (Front View) *</label>
                    <div class="image-upload-area main-image-upload" id="mainImageUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-camera"></i>
                        </div>
                        <div class="upload-text">Upload Main Vehicle Image</div>
                        <div class="upload-hint">This will be the first image customers see</div>
                        <input type="file" id="mainVehicleImage" accept="image/*" style="display: none;">
                    </div>
                    <div class="main-image-preview" id="mainImagePreview">
                        <!-- Main image preview will be added here -->
                    </div>
                </div>
                
                <!-- Additional Images Upload -->
                <div class="form-group">
                    <label class="form-label">Additional Images (Side, Back, Interior)</label>
                    <div class="image-upload-area" id="imageUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-images"></i>
                        </div>
                        <div class="upload-text">Upload Additional Images</div>
                        <div class="upload-hint">Show different angles and interior of your vehicle</div>
                        <input type="file" id="vehicleImages" multiple accept="image/*" style="display: none;">
                    </div>
                    <div class="image-preview" id="imagePreview">
                        <!-- Image previews will be added here -->
                    </div>
                </div>
                
                <!-- Video Upload -->
                <div class="form-group">
                    <label class="form-label">Vehicle Video (Optional)</label>
                    <div class="video-upload-area" id="videoUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-video"></i>
                        </div>
                        <div class="upload-text">Upload Vehicle Video</div>
                        <div class="upload-hint">Show your vehicle in action (max 50MB)</div>
                        <input type="file" id="vehicleVideo" accept="video/*" style="display: none;">
                    </div>
                    <div class="video-preview" id="videoPreview">
                        <!-- Video preview will be added here -->
                    </div>
                </div>
            </div>

            <!-- Description Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-edit"></i>
                    Vehicle Description
                </h3>
                
                <div class="form-group">
                    <label class="form-label" for="description">Describe Your Vehicle</label>
                    <textarea id="description" class="form-input form-textarea" placeholder="Tell potential customers about your vehicle, driver experience, and any special features..."></textarea>
                </div>
            </div>

            <!-- Contact Information Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-phone"></i>
                    Contact Information
                </h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="ownerName">Owner/Driver Name *</label>
                        <input type="text" id="ownerName" class="form-input" placeholder="Your full name" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="phoneNumber">Phone Number *</label>
                        <input type="tel" id="phoneNumber" class="form-input" placeholder="+27 82 123 4567" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="email">Email Address</label>
                        <input type="email" id="email" class="form-input" placeholder="your.email@example.com">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="whatsapp">WhatsApp Number</label>
                        <input type="tel" id="whatsapp" class="form-input" placeholder="+27 82 123 4567">
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="saveDraft()">
                    <i class="fas fa-save"></i>
                    Save as Draft
                </button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-paper-plane"></i>
                    Publish Vehicle
                </button>
            </div>
        </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    <script>
        // Global variables
        let map;
        let uploadedImages = [];
        let mainImage = null;
        let uploadedVideo = null;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializeMap();
            setupImageUpload();
            setupFormValidation();
        });

        // Initialize map for coverage areas
        function initializeMap() {
            map = new mapboxgl.Map({
                container: 'coverageMap',
                style: 'mapbox://styles/mapbox/streets-v12',
                center: [-26.2041, 28.0473], // Johannesburg
                zoom: 10
            });
            
            map.on('load', function() {
                // Add coverage area visualization
                addCoverageVisualization();
            });
        }

        // Add coverage area visualization
        function addCoverageVisualization() {
            // Example coverage areas
            const areas = [
                { name: 'Johannesburg CBD', center: [-26.2041, 28.0473], radius: 5 },
                { name: 'Soweto', center: [-26.2485, 27.9083], radius: 8 },
                { name: 'Sandton', center: [-26.1076, 28.0567], radius: 6 },
                { name: 'Pretoria', center: [-25.7479, 28.2293], radius: 7 }
            ];
            
            areas.forEach(area => {
                // Add circle for coverage area
                map.addSource(`coverage-${area.name}`, {
                    type: 'geojson',
                    data: {
                        type: 'Feature',
                        geometry: {
                            type: 'Point',
                            coordinates: area.center
                        }
                    }
                });
                
                map.addLayer({
                    id: `coverage-${area.name}`,
                    type: 'circle',
                    source: `coverage-${area.name}`,
                    paint: {
                        'circle-radius': area.radius * 1000, // Convert km to meters
                        'circle-color': '#01386A',
                        'circle-opacity': 0.2,
                        'circle-stroke-color': '#01386A',
                        'circle-stroke-width': 2
                    }
                });
            });
        }

        // Setup image upload
        function setupImageUpload() {
            // Main image upload
            const mainUploadArea = document.getElementById('mainImageUploadArea');
            const mainFileInput = document.getElementById('mainVehicleImage');
            const mainPreview = document.getElementById('mainImagePreview');

            mainUploadArea.addEventListener('click', () => mainFileInput.click());
            mainFileInput.addEventListener('change', (e) => {
                handleMainImage(e.target.files[0]);
            });

            // Additional images upload
            const uploadArea = document.getElementById('imageUploadArea');
            const fileInput = document.getElementById('vehicleImages');
            const preview = document.getElementById('imagePreview');

            uploadArea.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', (e) => {
                handleFiles(e.target.files);
            });

            // Video upload
            const videoUploadArea = document.getElementById('videoUploadArea');
            const videoFileInput = document.getElementById('vehicleVideo');
            const videoPreview = document.getElementById('videoPreview');

            videoUploadArea.addEventListener('click', () => videoFileInput.click());
            videoFileInput.addEventListener('change', (e) => {
                handleVideo(e.target.files[0]);
            });

            // Drag and drop for all areas
            [mainUploadArea, uploadArea, videoUploadArea].forEach(area => {
                area.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    area.classList.add('dragover');
                });

                area.addEventListener('dragleave', () => {
                    area.classList.remove('dragover');
                });

                area.addEventListener('drop', (e) => {
                    e.preventDefault();
                    area.classList.remove('dragover');
                    if (area === mainUploadArea) {
                        handleMainImage(e.dataTransfer.files[0]);
                    } else if (area === videoUploadArea) {
                        handleVideo(e.dataTransfer.files[0]);
                    } else {
                        handleFiles(e.dataTransfer.files);
                    }
                });
            });
        }

        // Handle main image upload
        function handleMainImage(file) {
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageData = {
                        file: file,
                        url: e.target.result,
                        isMain: true
                    };
                    mainImage = imageData;
                    displayMainImagePreview(imageData);
                };
                reader.readAsDataURL(file);
            }
        }

        // Handle video upload
        function handleVideo(file) {
            if (file && file.type.startsWith('video/')) {
                // Check file size (50MB limit)
                if (file.size > 50 * 1024 * 1024) {
                    alert('Video file is too large. Please choose a file smaller than 50MB.');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const videoData = {
                        file: file,
                        url: e.target.result
                    };
                    uploadedVideo = videoData;
                    displayVideoPreview(videoData);
                };
                reader.readAsDataURL(file);
            }
        }

        // Handle uploaded files
        function handleFiles(files) {
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const imageData = {
                            file: file,
                            url: e.target.result
                        };
                        uploadedImages.push(imageData);
                        displayImagePreview(imageData);
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        // Display main image preview
        function displayMainImagePreview(imageData) {
            const preview = document.getElementById('mainImagePreview');
            preview.innerHTML = `
                <div class="preview-item">
                    <img src="${imageData.url}" alt="Main vehicle image">
                    <button class="preview-remove" onclick="removeMainImage()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
        }

        // Display video preview
        function displayVideoPreview(videoData) {
            const preview = document.getElementById('videoPreview');
            const fileSize = (videoData.file.size / (1024 * 1024)).toFixed(2);
            preview.innerHTML = `
                <div class="video-preview-item">
                    <video controls>
                        <source src="${videoData.url}" type="${videoData.file.type}">
                        Your browser does not support the video tag.
                    </video>
                    <div class="video-info">
                        <div class="video-name">${videoData.file.name}</div>
                        <div class="video-size">${fileSize} MB</div>
                    </div>
                    <button class="preview-remove" onclick="removeVideo()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
        }

        // Display image preview
        function displayImagePreview(imageData) {
            const preview = document.getElementById('imagePreview');
            const previewItem = document.createElement('div');
            previewItem.className = 'preview-item';
            previewItem.innerHTML = `
                <img src="${imageData.url}" alt="Vehicle image">
                <button class="preview-remove" onclick="removeImage(this)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            preview.appendChild(previewItem);
        }

        // Remove main image
        function removeMainImage() {
            mainImage = null;
            document.getElementById('mainImagePreview').innerHTML = '';
        }

        // Remove video
        function removeVideo() {
            uploadedVideo = null;
            document.getElementById('videoPreview').innerHTML = '';
        }

        // Remove image
        function removeImage(button) {
            const previewItem = button.closest('.preview-item');
            const index = Array.from(document.querySelectorAll('.preview-item')).indexOf(previewItem);
            uploadedImages.splice(index, 1);
            previewItem.remove();
        }

        // Setup form validation
        function setupFormValidation() {
            const form = document.getElementById('vehiclePostForm');
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (validateForm()) {
                    submitVehicle();
                }
            });
        }

        // Validate form
        function validateForm() {
            const requiredFields = ['vehicleName', 'vehicleType', 'registration', 'capacity', 'ratePerKm', 'ownerName', 'phoneNumber'];
            let isValid = true;

            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                    field.style.borderColor = '#dc3545';
                    isValid = false;
                } else {
                    field.style.borderColor = '#e9ecef';
                }
            });

            // Check if at least one coverage area is selected
            const coverageCheckboxes = document.querySelectorAll('input[type="checkbox"][id^="jhb_"], input[type="checkbox"][id^="soweto"], input[type="checkbox"][id^="sandton"], input[type="checkbox"][id^="pretoria"], input[type="checkbox"][id^="centurion"], input[type="checkbox"][id^="midrand"], input[type="checkbox"][id^="randburg"], input[type="checkbox"][id^="roodepoort"]');
            const coverageSelected = Array.from(coverageCheckboxes).some(cb => cb.checked);
            
            if (!coverageSelected) {
                alert('Please select at least one coverage area.');
                isValid = false;
            }

            return isValid;
        }

        // Submit vehicle
        function submitVehicle() {
            const formData = {
                vehicleName: document.getElementById('vehicleName').value,
                vehicleType: document.getElementById('vehicleType').value,
                registration: document.getElementById('registration').value,
                capacity: document.getElementById('capacity').value,
                ratePerKm: document.getElementById('ratePerKm').value,
                minimumFare: document.getElementById('minimumFare').value,
                amenities: getSelectedAmenities(),
                coverageAreas: getSelectedCoverageAreas(),
                maxDistance: document.getElementById('maxDistance').value,
                description: document.getElementById('description').value,
                ownerName: document.getElementById('ownerName').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                email: document.getElementById('email').value,
                whatsapp: document.getElementById('whatsapp').value,
                mainImage: mainImage,
                images: uploadedImages,
                video: uploadedVideo
            };

            // In real app, send to backend
            console.log('Vehicle data:', formData);
            
            // Show success message
            alert('Vehicle posted successfully! It will be reviewed and published within 24 hours.');
            
            // Redirect to dashboard
            window.location.href = 'owner-dashboard.html';
        }

        // Get selected amenities
        function getSelectedAmenities() {
            const amenities = [];
            document.querySelectorAll('input[type="checkbox"][id^="ac"], input[type="checkbox"][id^="music"], input[type="checkbox"][id^="wifi"], input[type="checkbox"][id^="charging"], input[type="checkbox"][id^="luggage"], input[type="checkbox"][id^="wheelchair"]').forEach(cb => {
                if (cb.checked) {
                    amenities.push(cb.value);
                }
            });
            return amenities;
        }

        // Get selected coverage areas
        function getSelectedCoverageAreas() {
            const areas = [];
            document.querySelectorAll('input[type="checkbox"][id^="jhb_"], input[type="checkbox"][id^="soweto"], input[type="checkbox"][id^="sandton"], input[type="checkbox"][id^="pretoria"], input[type="checkbox"][id^="centurion"], input[type="checkbox"][id^="midrand"], input[type="checkbox"][id^="randburg"], input[type="checkbox"][id^="roodepoort"]').forEach(cb => {
                if (cb.checked) {
                    areas.push(cb.value);
                }
            });
            return areas;
        }

        // Save as draft
        function saveDraft() {
            const formData = {
                vehicleName: document.getElementById('vehicleName').value,
                vehicleType: document.getElementById('vehicleType').value,
                registration: document.getElementById('registration').value,
                capacity: document.getElementById('capacity').value,
                ratePerKm: document.getElementById('ratePerKm').value,
                minimumFare: document.getElementById('minimumFare').value,
                amenities: getSelectedAmenities(),
                coverageAreas: getSelectedCoverageAreas(),
                maxDistance: document.getElementById('maxDistance').value,
                description: document.getElementById('description').value,
                ownerName: document.getElementById('ownerName').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                email: document.getElementById('email').value,
                whatsapp: document.getElementById('whatsapp').value,
                images: uploadedImages,
                status: 'draft'
            };

            // In real app, save to backend
            console.log('Draft saved:', formData);
            alert('Draft saved successfully!');
        }
    </script>
</body>
</html>
