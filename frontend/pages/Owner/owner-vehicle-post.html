<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Your Vehicle | TeksiMap</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../../assets/icons/favicon.ico">
    <link rel="icon" type="image/png" href="../../assets/icons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="../../assets/icons/favicon-32x32.png" sizes="32x32">
    <link rel="apple-touch-icon" href="../../assets/icons/apple-touch-icon.svg">
    <link rel="manifest" href="../../assets/icons/site.webmanifest">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../../css/clientStyle.css">
    <link rel="stylesheet" href="../../css/topnav.css">
    <link rel="stylesheet" href="../../css/booking.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css">
    
    <style>
        /* Topnav Fixed Position */
        .topnav {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            width: 100% !important;
            z-index: 1000 !important;
        }

        /* Add padding to body to account for fixed topnav */
        html {
            overflow-x: hidden !important;
            overflow-y: auto !important;
            height: auto !important;
            min-height: 100vh !important;
        }

        body {
            background: linear-gradient(135deg, #01386A 0%, #025aa5 100%) !important;
            padding-top: 70px !important;
            overflow-x: hidden !important;
            overflow-y: auto !important;
            height: auto !important;
            min-height: 100vh !important;
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #01386A 0%, #025aa5 100%);
            z-index: -1;
        }

        /* Logout Button Styling */
        .nav-logout-btn {
            background: #dc3545 !important;
            color: white !important;
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 10px;
            white-space: nowrap;
        }
        
        .nav-logout-btn:hover {
            background: #c82333 !important;
            text-decoration: none !important;
            transform: translateY(-1px);
        }
        
        .nav-logout-btn i {
            font-size: 14px;
        }

        /* Navigation links spacing */
        @media (min-width: 769px) {
            .nav-links {
                gap: 30px;
            }
        }
        
        @media (max-width: 768px) {
            .full-navigation {
                flex-direction: column;
                gap: 0.5rem;
                width: 100%;
            }

            .nav-logout-btn {
                margin-left: 0 !important;
                margin-top: 10px;
                justify-content: center;
                width: calc(100% - 30px);
                padding: 12px 16px;
            }
        }

        .wrapper {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .page-content {
            flex: 1;
            padding: 2rem 1rem;
        }

        .vehicle-post-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2.5rem;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.5s ease;
            min-height: calc(100vh - 70px);
            overflow-x: hidden !important;
            overflow-y: visible !important;
            height: auto !important;
            max-height: none !important;
            padding-bottom: 4rem !important;
        }

        @media (min-width: 1024px) and (max-width: 1399px) {
            .vehicle-post-container {
                max-width: 1200px;
            }
        }

        @media (min-width: 1600px) {
            .vehicle-post-container {
                max-width: 1600px;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .post-content {
            max-width: 100%;
            margin: 0 auto;
            overflow-x: hidden !important;
            overflow-y: visible !important;
            height: auto !important;
            max-height: none !important;
        }
        
        .post-header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 3px solid #f0f0f0;
            position: relative;
            background: transparent;
        }

        .post-header::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(135deg, #FFD52F 0%, #FFC107 100%);
            border-radius: 2px;
        }
        
        .post-title {
            color: #01386A;
            font-size: 2.8rem;
            margin-bottom: 0.75rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .post-title i {
            color: #FFD52F;
            font-size: 3rem;
        }
        
        .post-subtitle {
            color: #666;
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .post-form {
            background: transparent;
            padding: 0;
            border-radius: 0;
            box-shadow: none;
            margin-bottom: 0;
            overflow: visible !important;
            height: auto !important;
            min-height: auto !important;
        }
        
        .form-section {
            margin-bottom: 2rem;
            padding: 2.5rem;
            border: 2px solid #e9ecef;
            border-radius: 18px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            overflow: visible !important;
            height: auto !important;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        @media (min-width: 1024px) {
            .form-section {
                padding: 3rem;
            }
        }
        
        .section-title {
            font-size: 1.6rem;
            font-weight: 700;
            color: #01386A;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .section-title::before {
            content: '';
            width: 5px;
            height: 40px;
            background: linear-gradient(135deg, #FFD52F 0%, #FFC107 100%);
            border-radius: 3px;
        }

        .section-title i {
            color: #FFD52F;
            font-size: 1.4rem;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            width: 100%;
            box-sizing: border-box;
        }

        @media (min-width: 1024px) {
            .form-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 2.5rem;
            }
        }

        @media (min-width: 1400px) {
            .form-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 2.5rem;
            }
        }

        @media (min-width: 1600px) {
            .form-grid {
                gap: 3rem;
            }
        }
        
        .form-group {
            margin-bottom: 0;
            display: flex;
            flex-direction: column;
            width: 100%;
            box-sizing: border-box;
            padding-right: 0;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.75rem;
            font-weight: 700;
            color: #01386A;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-label i {
            color: #FFD52F;
            font-size: 1.1rem;
        }
        
        .form-input {
            width: 100%;
            max-width: 100%;
            padding: 1rem;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
            color: #01386A;
            box-sizing: border-box;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #FFD52F;
            box-shadow: 0 0 0 4px rgba(255, 213, 47, 0.2);
        }

        .form-input::placeholder {
            color: #adb5bd;
        }
        
        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }
        
        .form-select {
            width: 100%;
            max-width: 100%;
            padding: 1rem;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
            color: #01386A;
            box-sizing: border-box;
        }
        
        .form-select:focus {
            outline: none;
            border-color: #FFD52F;
            box-shadow: 0 0 0 4px rgba(255, 213, 47, 0.2);
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 1rem;
            background: white;
            border-radius: 12px;
            border: 3px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        
        .checkbox-item:hover {
            border-color: #FFD52F;
            background: white;
            box-shadow: 0 6px 20px rgba(255, 213, 47, 0.15);
            transform: translateY(-2px);
        }
        
        .checkbox-item input[type="checkbox"],
        .checkbox-item input[type="radio"] {
            margin: 0;
            accent-color: #01386A;
        }
        
        .checkbox-item input[type="radio"]:checked {
            accent-color: #01386A;
        }
        
        .coverage-map-container {
            height: 400px;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #e9ecef;
            margin-top: 1rem;
        }
        
        .rate-input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .rate-input-group .form-input {
            flex: 1;
        }
        
        .rate-suffix {
            color: #6c757d;
            font-weight: 600;
        }
        
        .image-upload-area, .video-upload-area {
            border: 3px dashed #01386A;
            border-radius: 15px;
            padding: 2.5rem;
            text-align: center;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }
        
        .image-upload-area:hover, .video-upload-area:hover {
            background: #f8f9fa;
            border-color: #FFD52F;
            box-shadow: 0 6px 20px rgba(255, 213, 47, 0.15);
            transform: translateY(-2px);
        }
        
        .image-upload-area.dragover, .video-upload-area.dragover {
            background: #e3f2fd;
            border-color: #1976d2;
        }
        
        .main-image-upload {
            border-color: #FFD52F;
            background: linear-gradient(135deg, rgba(255, 213, 47, 0.05) 0%, rgba(255, 193, 7, 0.05) 100%);
        }
        
        .main-image-upload:hover {
            background: linear-gradient(135deg, rgba(255, 213, 47, 0.1) 0%, rgba(255, 193, 7, 0.1) 100%);
            border-color: #FFC107;
        }
        
        .upload-icon {
            font-size: 3.5rem;
            color: #FFD52F;
            margin-bottom: 1rem;
        }
        
        .upload-text {
            font-size: 1.2rem;
            font-weight: 700;
            color: #01386A;
            margin-bottom: 0.5rem;
        }
        
        .upload-hint {
            color: #6c757d;
            font-size: 0.95rem;
        }
        
        .image-preview, .main-image-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .main-image-preview {
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        }
        
        .preview-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .preview-item img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }
        
        .main-image-preview .preview-item img {
            height: 150px;
        }
        
        .preview-remove {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .video-preview {
            margin-top: 1rem;
        }
        
        .video-preview-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 300px;
        }
        
        .video-preview-item video {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .video-info {
            padding: 1rem;
            background: #f8f9fa;
            border-top: 1px solid #e9ecef;
        }
        
        .video-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.3rem;
        }
        
        .video-size {
            font-size: 0.8rem;
            color: #6c757d;
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
            margin-bottom: 3rem;
        }
        
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #01386A 0%, #025aa5 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(1, 56, 106, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(1, 56, 106, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }
        
        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(108, 117, 125, 0.4);
        }
        
        .progress-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 4rem;
            margin-bottom: 4rem;
            position: relative;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 3rem 2rem;
            border-radius: 15px;
        }

        @media (min-width: 1400px) {
            .progress-indicator {
                gap: 6rem;
            }
        }
        
        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
            flex: 0 0 auto;
        }

        .progress-step::after {
            content: '';
            position: absolute;
            left: calc(100% + 30px);
            top: 30px;
            width: 4rem;
            height: 4px;
            background: #e0e0e0;
            z-index: -1;
            transition: all 0.4s ease;
        }

        @media (min-width: 1400px) {
            .progress-step::after {
                width: 6rem;
            }
        }

        .progress-step.completed::after {
            background: linear-gradient(90deg, #01386A 0%, #025aa5 100%);
        }

        .progress-step:last-child::after {
            display: none;
        }
        
        .step-number {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: white;
            color: #999;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.5rem;
            margin-bottom: 0.75rem;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            border: 4px solid #e0e0e0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }
        
        .progress-step.active .step-number {
            background: linear-gradient(135deg, #FFD52F 0%, #FFC107 100%);
            color: #01386A;
            border-color: #FFD52F;
            transform: scale(1.15);
            box-shadow: 0 8px 25px rgba(255, 213, 47, 0.4);
        }
        
        .progress-step.completed .step-number {
            background: linear-gradient(135deg, #01386A 0%, #025aa5 100%);
            color: white;
            border-color: #01386A;
            box-shadow: 0 4px 15px rgba(1, 56, 106, 0.3);
        }

        .progress-step.completed .step-number::before {
            content: '✓';
            position: absolute;
        }
        
        .step-label {
            color: #7f8c8d;
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .progress-step.active .step-label {
            color: #01386A;
            font-weight: 700;
        }

        .progress-step.completed .step-label {
            color: #01386A;
        }
        
        @media (max-width: 768px) {
            .page-content {
                padding: 1rem 0.5rem;
            }

            .vehicle-post-container {
                padding: 1.5rem;
                padding-bottom: 3rem !important;
                border-radius: 15px;
            }

            .post-header h1, .post-title {
                font-size: 2rem;
            }

            .post-header p, .post-subtitle {
                font-size: 1rem;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .checkbox-group {
                grid-template-columns: 1fr;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }

            .progress-indicator {
                gap: 2rem;
                padding: 2rem 1rem;
            }

            .progress-line {
                width: 2rem;
            }

            html, body {
                overflow-x: hidden !important;
                overflow-y: auto !important;
                height: auto !important;
            }
        }

        /* Review Section Styles */
        .review-section {
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.5s ease;
        }

        .review-header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 3px solid #f0f0f0;
            position: relative;
        }

        .review-header::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(135deg, #FFD52F 0%, #FFC107 100%);
            border-radius: 2px;
        }

        .review-header h2 {
            color: #01386A;
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .review-header h2 i {
            color: #FFD52F;
            font-size: 2.5rem;
        }

        .review-header p {
            color: #666;
            font-size: 1.1rem;
            max-width: 700px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .review-content {
            margin-bottom: 3rem;
        }

        .review-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 2px solid #e9ecef;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .review-card-title {
            color: #01386A;
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
            padding-bottom: 1rem;
            border-bottom: 2px solid #dee2e6;
        }

        .review-card-title i {
            color: #FFD52F;
            font-size: 1.5rem;
        }

        .review-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .review-item {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            border-left: 4px solid #FFD52F;
        }

        .review-item-label {
            font-size: 0.85rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .review-item-value {
            font-size: 1.1rem;
            color: #01386A;
            font-weight: 600;
            word-break: break-word;
        }

        .review-item-value i {
            color: #FFD52F;
            margin-right: 0.5rem;
        }

        .review-actions {
            display: flex;
            gap: 1.5rem;
            justify-content: center;
            padding-top: 2rem;
            border-top: 2px solid #f0f0f0;
        }

        .review-actions .btn {
            min-width: 200px;
        }

        /* Success Message Styles */
        .success-message {
            background: white;
            border-radius: 20px;
            padding: 4rem 2.5rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.5s ease;
            text-align: center;
        }

        .success-content {
            max-width: 600px;
            margin: 0 auto;
        }

        .success-icon {
            font-size: 5rem;
            color: #28a745;
            margin-bottom: 1.5rem;
            animation: scaleIn 0.5s ease;
        }

        @keyframes scaleIn {
            from {
                transform: scale(0);
            }
            to {
                transform: scale(1);
            }
        }

        .success-message h2 {
            color: #01386A;
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .success-message p {
            color: #666;
            font-size: 1.2rem;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .success-note {
            background: linear-gradient(135deg, #fff9e6 0%, #fff3cd 100%);
            border-left: 4px solid #FFD52F;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 2rem 0;
            color: #856404;
            font-size: 1rem;
        }

        .success-actions {
            margin-top: 2.5rem;
        }

        @media (max-width: 768px) {
            .review-section {
                padding: 1.5rem;
            }

            .review-header h2 {
                font-size: 2rem;
            }

            .review-details {
                grid-template-columns: 1fr;
            }

            .review-actions {
                flex-direction: column;
            }

            .review-actions .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Top navigation bar -->
    <nav class="topnav">
        <div class="nav-container">
            <div class="logo">
                <a href="../../index.html">
                    <img src="../../assets/icons/logo-advanced-white.svg" alt="TeksiMap Logo" class="h-10 w-auto" />
                </a>
            </div>

            <!-- Burger button for mobile -->
            <div class="burger" onclick="toggleMobileMenu()">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>

            <!-- Navigation links -->
            <div class="nav-links" id="mobileMenu">
                <a href="../customer/client.html" onclick="topNavZIndexDecrease()">Find route</a>
                <a href="../customer/booking-type-selection.html" onclick="topNavZIndexDecrease()">Book Taxi</a>
                <a href="../customer/help.html" onclick="topNavZIndexDecrease()">Help</a>
                <!-- Login/Signup buttons for non-logged in users -->
                <div id="authButtons" class="auth-buttons">
                    <a href="../authentication/login.html" class="btn-login">Login</a>
                    <a href="../authentication/signup.html" class="btn-signup">Sign Up</a>
                </div>
                <!-- Full navigation for logged in users -->
                <div id="fullNav" class="full-navigation" style="display: none;">
                    <a href="../customer/route-suggestion.html" onclick="topNavZIndexDecrease()">Suggest route</a>
                    <a href="../customer/feedback.html" onclick="topNavZIndexDecrease()">Feedback</a>
                    <a href="../authentication/profile.html" onclick="topNavZIndexDecrease()">Profile</a>
                    <a href="owner-dashboard.html" onclick="topNavZIndexDecrease()" style="background: #ffc107; color: #000; font-weight: 600; border-radius: 5px; padding: 5px 10px;">Owner Dashboard</a>
                    <a href="../driver/driver-dashboard.html" onclick="topNavZIndexDecrease()" style="background: #01386A; color: #fff; font-weight: 600; border-radius: 5px; padding: 5px 10px;">Driver Portal</a>
                    <a href="#" class="nav-logout-btn" id="logoutBtn" onclick="topNavZIndexDecrease()">
                        <i class="fas fa-sign-out-alt"></i>
                        Logout
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="wrapper">
        <div class="page-content">
            <div class="vehicle-post-container">
                <div class="post-content">
            <!-- Header -->
            <div class="post-header">
                <h1 class="post-title">
                    <i class="fas fa-car"></i>
                    Post Your Vehicle
                </h1>
                <p class="post-subtitle">List your taxi or bus on TeksiMap and start earning</p>
            </div>

        <!-- Progress Indicator -->
        <div class="progress-indicator">
            <div class="progress-step completed" id="step1">
                <div class="step-number">✓</div>
                <div class="step-label">Vehicle Info</div>
            </div>
            <div class="progress-line completed"></div>
            <div class="progress-step" id="step2">
                <div class="step-number">2</div>
                <div class="step-label">Review & Publish</div>
            </div>
        </div>

        <!-- Vehicle Posting Form -->
        <form id="vehiclePostForm" class="post-form">
            <!-- Taxi Type Selection Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-clipboard-list"></i>
                    Taxi Type Selection
                </h3>
                
                <div class="form-group">
                    <label class="form-label">Taxi Service Type</label>
                    <div style="margin-bottom: 1rem;">
                        <div class="checkbox-item" style="margin-bottom: 0.5rem;">
                            <input type="radio" id="taxiType_long" name="taxiServiceType" value="long-distance" checked>
                            <label for="taxiType_long" style="margin-left: 0.5rem; cursor: pointer;">Long-distance Taxi</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="radio" id="taxiType_local" name="taxiServiceType" value="local">
                            <label for="taxiType_local" style="margin-left: 0.5rem; cursor: pointer;">Local Taxi</label>
                        </div>
                        <div class="checkbox-item" style="margin-top: 0.5rem;">
                            <input type="radio" id="taxiType_none" name="taxiServiceType" value="">
                            <label for="taxiType_none" style="margin-left: 0.5rem; cursor: pointer; font-style: italic;">None (Private only)</label>
                        </div>
                    </div>
                    
                    <div class="checkbox-item" style="margin-top: 1rem; padding: 1rem; background: #e3f2fd; border: 2px solid #2196f3;">
                        <input type="checkbox" id="isPrivateTaxi" name="isPrivateTaxi">
                        <label for="isPrivateTaxi" style="margin-left: 0.5rem; cursor: pointer; font-weight: 600;">Also offer as Private Taxi (for private hiring/bookings)</label>
                    </div>
                </div>
            </div>

            <!-- Route Selection Section (Long-distance/Local Only) -->
            <div class="form-section" id="routeSelectionSection" style="display: none;">
                <h3 class="section-title">
                    <i class="fas fa-route"></i>
                    Route Selection
                </h3>
                
                <!-- Long-distance Routes -->
                <div id="longDistanceRoutes" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">Select Your Long-distance Route *</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="radio" id="route_pretoria_tzaneen" name="longDistanceRoute" value="pretoria-tzaneen">
                                <label for="route_pretoria_tzaneen" style="margin-left: 0.5rem; cursor: pointer;">Pretoria ↔ Tzaneen</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="radio" id="route_jhb_tzaneen" name="longDistanceRoute" value="jhb-tzaneen">
                                <label for="route_jhb_tzaneen" style="margin-left: 0.5rem; cursor: pointer;">Johannesburg ↔ Tzaneen</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Local Routes -->
                <div id="localRoutes" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">Select Your Local Operating Area(s) *</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="local_johannesburg" name="localRoutes" value="johannesburg">
                                <label for="local_johannesburg">Johannesburg</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="local_pretoria" name="localRoutes" value="pretoria">
                                <label for="local_pretoria">Pretoria</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="local_tzaneen" name="localRoutes" value="tzaneen">
                                <label for="local_tzaneen">Tzaneen</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Vehicle Information Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-car"></i>
                    Vehicle Information
                </h3>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="vehicleMake">
                            <i class="fas fa-industry"></i>
                            Make *
                        </label>
                        <select id="vehicleMake" class="form-select" required>
                            <option value="">Select make</option>
                            <option value="Toyota">Toyota</option>
                            <option value="Nissan">Nissan</option>
                            <option value="Mercedes-Benz">Mercedes-Benz</option>
                            <option value="Iveco">Iveco</option>
                            <option value="Hyundai">Hyundai</option>
                            <option value="Ford">Ford</option>
                            <option value="Volkswagen">Volkswagen</option>
                            <option value="Other">Other</option>
                        </select>
                        <input type="text" id="vehicleMakeOther" class="form-input" placeholder="Enter make name" style="display: none; margin-top: 0.5rem;">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="vehicleModel">
                            <i class="fas fa-car"></i>
                            Model *
                        </label>
                        <select id="vehicleModel" class="form-select" required>
                            <option value="">Select model</option>
                            <option value="Toyota Quantum">Toyota Quantum</option>
                            <option value="Toyota Hiace Ses'fikile">Toyota Hiace Ses'fikile</option>
                            <option value="Toyota Coaster">Toyota Coaster</option>
                            <option value="Nissan NV350 Impendulo">Nissan NV350 Impendulo</option>
                            <option value="Mercedes-Benz Sprinter">Mercedes-Benz Sprinter</option>
                            <option value="Iveco Daily">Iveco Daily</option>
                            <option value="Hyundai Staria / H-1">Hyundai Staria / H-1</option>
                            <option value="Volkswagen Crafter">Volkswagen Crafter</option>
                            <option value="Ford Transit">Ford Transit</option>
                            <option value="Other">Other</option>
                        </select>
                        <input type="text" id="vehicleModelOther" class="form-input" placeholder="Enter model name" style="display: none; margin-top: 0.5rem;">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="vehicleColor">
                            <i class="fas fa-palette"></i>
                            Color *
                        </label>
                        <select id="vehicleColor" class="form-select" required>
                            <option value="">Select color</option>
                            <option value="White">White</option>
                            <option value="Silver">Silver</option>
                            <option value="Grey">Grey</option>
                            <option value="Black">Black</option>
                            <option value="Blue">Blue</option>
                            <option value="Beige">Beige</option>
                            <option value="Yellow">Yellow</option>
                            <option value="Gold">Gold</option>
                            <option value="Other">Other</option>
                        </select>
                        <input type="text" id="vehicleColorOther" class="form-input" placeholder="Enter color name" style="display: none; margin-top: 0.5rem;">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="vehicleType">
                            <i class="fas fa-shapes"></i>
                            Vehicle Type *
                        </label>
                        <select id="vehicleType" class="form-select" required>
                            <option value="">Select vehicle type</option>
                            <option value="minibus">Minibus</option>
                            <option value="van">Van</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="registration">
                            <i class="fas fa-id-card"></i>
                            Registration Number *
                        </label>
                        <input type="text" id="registration" class="form-input" placeholder="e.g., CA 123-456" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="licensePlate">
                            <i class="fas fa-car-side"></i>
                            License Plate *
                        </label>
                        <input type="text" id="licensePlate" class="form-input" placeholder="e.g., ABC 123 GP" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="capacity">
                            <i class="fas fa-users"></i>
                            Seating Capacity *
                        </label>
                        <input type="number" id="capacity" class="form-input" placeholder="16" min="10" max="22" required>
                        <small style="color: #6c757d; font-size: 0.85rem; display: block; margin-top: 0.25rem;">
                            Minimum: 10 seats | Maximum: 22 seats
                        </small>
                    </div>
                </div>
            </div>

            <!-- Amenities Section (Private Only) -->
            <div class="form-section" id="amenitiesSection" style="display: none;">
                <h3 class="section-title">
                    <i class="fas fa-star"></i>
                    Amenities & Features
                </h3>
                
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="ac" value="AC">
                        <label for="ac">Air Conditioning</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="music" value="Music">
                        <label for="music">Music System</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="wifi" value="WiFi">
                        <label for="wifi">WiFi</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="charging" value="Charging Ports">
                        <label for="charging">Charging Ports</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="luggage" value="Luggage Space">
                        <label for="luggage">Luggage Space</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="wheelchair" value="Wheelchair Accessible">
                        <label for="wheelchair">Wheelchair Accessible</label>
                    </div>
                </div>
            </div>

            <!-- Coverage Areas Section (Private Only) -->
            <div class="form-section" id="coverageSection" style="display: none;">
                <h3 class="section-title">
                    <i class="fas fa-map-marked-alt"></i>
                    Coverage Areas
                </h3>
                
                <div class="form-group">
                    <label class="form-label">Select Areas You're Willing to Travel To *</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="jhb_cbd" value="Johannesburg CBD">
                            <label for="jhb_cbd">Johannesburg CBD</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="soweto" value="Soweto">
                            <label for="soweto">Soweto</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="sandton" value="Sandton">
                            <label for="sandton">Sandton</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="pretoria" value="Pretoria">
                            <label for="pretoria">Pretoria</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="centurion" value="Centurion">
                            <label for="centurion">Centurion</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="midrand" value="Midrand">
                            <label for="midrand">Midrand</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="randburg" value="Randburg">
                            <label for="randburg">Randburg</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="roodepoort" value="Roodepoort">
                            <label for="roodepoort">Roodepoort</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="maxDistance">Maximum Travel Distance (km)</label>
                    <input type="number" id="maxDistance" class="form-input" placeholder="50" min="1" max="200" value="50">
                </div>
                
                <div class="coverage-map-container" id="coverageMap">
                    <!-- Map will be initialized here -->
                </div>
            </div>

            <!-- Vehicle Images Section -->
            <div class="form-section" id="imagesSection">
                <h3 class="section-title">
                    <i class="fas fa-images"></i>
                    Vehicle Images
                </h3>
                
                <!-- Main Image Upload -->
                <div class="form-group">
                    <label class="form-label">Main Image (Front View) *</label>
                    <div class="image-upload-area main-image-upload" id="mainImageUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-camera"></i>
                        </div>
                        <div class="upload-text">Upload Main Vehicle Image</div>
                        <div class="upload-hint">This will be the first image customers see</div>
                        <input type="file" id="mainVehicleImage" accept="image/*" style="display: none;">
                    </div>
                    <div class="main-image-preview" id="mainImagePreview">
                        <!-- Main image preview will be added here -->
                    </div>
                </div>
                
                <!-- Additional Images Upload -->
                <div class="form-group">
                    <label class="form-label">Additional Images (Side, Back, Interior)</label>
                    <div class="image-upload-area" id="imageUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-images"></i>
                        </div>
                        <div class="upload-text">Upload Additional Images</div>
                        <div class="upload-hint">Show different angles and interior of your vehicle</div>
                        <input type="file" id="vehicleImages" multiple accept="image/*" style="display: none;">
                    </div>
                    <div class="image-preview" id="imagePreview">
                        <!-- Image previews will be added here -->
                    </div>
                </div>
            </div>

            <!-- Video Upload Section (Private Only) -->
            <div class="form-section" id="videoSection" style="display: none;">
                <h3 class="section-title">
                    <i class="fas fa-video"></i>
                    Vehicle Videos
                </h3>
                
                <div class="form-group">
                    <label class="form-label">Vehicle Video (Optional)</label>
                    <div class="video-upload-area" id="videoUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-video"></i>
                        </div>
                        <div class="upload-text">Upload Vehicle Video</div>
                        <div class="upload-hint">Show your vehicle in action (max 50MB)</div>
                        <input type="file" id="vehicleVideo" accept="video/*" style="display: none;">
                    </div>
                    <div class="video-preview" id="videoPreview">
                        <!-- Video preview will be added here -->
                    </div>
                </div>
            </div>

            <!-- Description Section (Private Only) -->
            <div class="form-section" id="descriptionSection" style="display: none;">
                <h3 class="section-title">
                    <i class="fas fa-edit"></i>
                    Vehicle Description
                </h3>
                
                <div class="form-group">
                    <label class="form-label" for="description">Describe Your Vehicle</label>
                    <textarea id="description" class="form-input form-textarea" placeholder="Tell potential customers about your vehicle, driver experience, and any special features..."></textarea>
                </div>
            </div>

            <!-- Roadworthy Document Section (All Types) -->
            <div class="form-section" id="roadworthySection">
                <h3 class="section-title">
                    <i class="fas fa-file-alt"></i>
                    Roadworthy Submission Document
                </h3>
                
                <div class="form-group">
                    <label class="form-label">Upload Roadworthy Certificate *</label>
                    <div class="image-upload-area" id="roadworthyUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="upload-text">Upload Roadworthy Certificate</div>
                        <div class="upload-hint">Upload a scanned copy or photo of your roadworthy certificate (PDF, JPG, PNG)</div>
                        <input type="file" id="roadworthyDocument" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                    </div>
                    <div class="image-preview" id="roadworthyPreview">
                        <!-- Roadworthy document preview will be added here -->
                    </div>
                </div>
            </div>

            <!-- Route Permit Document Section (Long-distance/Local Only) -->
            <div class="form-section" id="routePermitSection" style="display: none;">
                <h3 class="section-title">
                    <i class="fas fa-id-card"></i>
                    Route Permit Document
                </h3>
                
                <div class="form-group">
                    <label class="form-label">Upload Route Permit *</label>
                    <div class="image-upload-area" id="routePermitUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <div class="upload-text">Upload Route Permit</div>
                        <div class="upload-hint">Upload a scanned copy or photo of your route permit (PDF, JPG, PNG)</div>
                        <input type="file" id="routePermitDocument" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                    </div>
                    <div class="image-preview" id="routePermitPreview">
                        <!-- Route permit document preview will be added here -->
                    </div>
                </div>
            </div>

            <!-- Driver Selection Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <i class="fas fa-user-tie"></i>
                    Driver Assignment
                </h3>
                <p class="section-description">Select a driver from your registered drivers to assign to this vehicle</p>
                
                <div class="form-grid">
                    <div class="form-group full-width">
                        <label class="form-label" for="selectedDriver">
                            <i class="fas fa-user-tie"></i>
                            Select Driver *
                        </label>
                        <select id="selectedDriver" class="form-select" required>
                            <option value="">-- Select a driver --</option>
                        </select>
                        <small class="text-muted" style="display: block; margin-top: 0.5rem; color: #6c757d;">
                            <i class="fas fa-info-circle"></i> 
                            <a href="owner-driver-post.html" target="_blank" style="color: #01386A; text-decoration: underline;">
                                Add a new driver
                            </a> if you don't see the driver you need
                        </small>
                    </div>
                </div>
                
                <!-- Driver Info Preview (shown after selection) -->
                <div id="driverInfoPreview" style="display: none; margin-top: 1.5rem; padding: 1.5rem; background: #f8f9fa; border-radius: 12px; border: 2px solid #e9ecef;">
                    <h4 style="margin: 0 0 1rem 0; color: #01386A; display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-user-check"></i> Selected Driver Information
                    </h4>
                    <div class="form-grid" id="driverPreviewContent">
                        <!-- Driver info will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="saveDraft()">
                    <i class="fas fa-save"></i>
                    Save as Draft
                </button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-eye"></i>
                    Review & Submit
                </button>
            </div>
        </form>

        <!-- Review Section (Hidden initially) -->
        <div id="reviewSection" class="review-section" style="display: none;">
            <div class="review-header">
                <h2>
                    <i class="fas fa-clipboard-check"></i>
                    Review Your Vehicle Information
                </h2>
                <p>Please review all the information below before submitting for approval.</p>
            </div>

            <div class="review-content">
                <div class="review-card">
                    <h3 class="review-card-title">
                        <i class="fas fa-car"></i>
                        Vehicle Information
                    </h3>
                    <div class="review-details" id="reviewVehicleInfo">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="review-card" id="reviewTaxiTypeCard" style="display: none;">
                    <h3 class="review-card-title">
                        <i class="fas fa-clipboard-list"></i>
                        Service Type & Routes
                    </h3>
                    <div class="review-details" id="reviewTaxiType">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="review-card" id="reviewContactCard">
                    <h3 class="review-card-title">
                        <i class="fas fa-user-tie"></i>
                        Driver Information
                    </h3>
                    <div class="review-details" id="reviewContact">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="review-card" id="reviewDocumentsCard">
                    <h3 class="review-card-title">
                        <i class="fas fa-file-alt"></i>
                        Documents
                    </h3>
                    <div class="review-details" id="reviewDocuments">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>
            </div>

            <div class="review-actions">
                <button type="button" class="btn btn-secondary" onclick="goBackToForm()">
                    <i class="fas fa-arrow-left"></i>
                    Back to Edit
                </button>
                <button type="button" class="btn btn-primary" onclick="confirmSubmission()">
                    <i class="fas fa-check-circle"></i>
                    Confirm & Submit for Approval
                </button>
            </div>
        </div>

        <!-- Submission Success Message (Hidden initially) -->
        <div id="successMessage" class="success-message" style="display: none;">
            <div class="success-content">
                <div class="success-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2>Vehicle Submitted Successfully!</h2>
                <p>Your vehicle has been submitted and is now <strong>Pending for Approval</strong>.</p>
                <p class="success-note">An admin will review your submission and approve it within 24-48 hours. You can check the status in your dashboard.</p>
                <div class="success-actions">
                    <button type="button" class="btn btn-primary" onclick="goToDashboard()">
                        <i class="fas fa-tachometer-alt"></i>
                        Go to Dashboard
                    </button>
                </div>
            </div>
        </div>
                </div>
                <!-- Extra padding at bottom to ensure scrolling reaches end -->
                <div style="height: 50px;"></div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
    <script>
        // Global variables
        let map;
        let uploadedImages = [];
        let mainImage = null;
        let uploadedVideo = null;
        let roadworthyDocument = null;
        let routePermitDocument = null;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            setupTaxiTypeSelection();
            setupDocumentUploads();
            setupImageUpload();
            setupFormValidation();
            loadDrivers(); // Load drivers for selection dropdown
            setupOtherOptions(); // Handle "Other" option for make, model, color
        });

        // Setup taxi type selection handlers
        function setupTaxiTypeSelection() {
            const taxiTypeRadios = document.querySelectorAll('input[name="taxiServiceType"]');
            const isPrivateCheckbox = document.getElementById('isPrivateTaxi');
            const noneRadio = document.getElementById('taxiType_none');
            
            // Handle taxi type change
            taxiTypeRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // If "None (Private only)" is selected, automatically check private checkbox
                    if (radio.id === 'taxiType_none' && radio.checked) {
                        isPrivateCheckbox.checked = true;
                    }
                    updateSectionVisibility();
                });
            });
            
            // Handle private taxi checkbox change
            isPrivateCheckbox.addEventListener('change', updateSectionVisibility);
            
            // Initial update
            updateSectionVisibility();
        }

        // Update section visibility based on taxi type
        function updateSectionVisibility() {
            const selectedTaxiType = document.querySelector('input[name="taxiServiceType"]:checked')?.value;
            const isPrivate = document.getElementById('isPrivateTaxi').checked;
            
            // Sections for long-distance/local
            const routePermitSection = document.getElementById('routePermitSection');
            const routeSelectionSection = document.getElementById('routeSelectionSection');
            const longDistanceRoutes = document.getElementById('longDistanceRoutes');
            const localRoutes = document.getElementById('localRoutes');
            
            // Sections for private only
            const amenitiesSection = document.getElementById('amenitiesSection');
            const coverageSection = document.getElementById('coverageSection');
            const videoSection = document.getElementById('videoSection');
            const descriptionSection = document.getElementById('descriptionSection');
            
            // Show route selection and route permit only for long-distance/local (not for private-only)
            if (selectedTaxiType === 'long-distance' || selectedTaxiType === 'local') {
                routeSelectionSection.style.display = 'block';
                routePermitSection.style.display = 'block';
                
                // Show appropriate route options
                if (selectedTaxiType === 'long-distance') {
                    longDistanceRoutes.style.display = 'block';
                    localRoutes.style.display = 'none';
                } else if (selectedTaxiType === 'local') {
                    longDistanceRoutes.style.display = 'none';
                    localRoutes.style.display = 'block';
                }
            } else {
                routeSelectionSection.style.display = 'none';
                routePermitSection.style.display = 'none';
                longDistanceRoutes.style.display = 'none';
                localRoutes.style.display = 'none';
            }
            
            // Show private sections if private is selected OR if no service type is selected (private-only registration)
            if (isPrivate || !selectedTaxiType || selectedTaxiType === '') {
                amenitiesSection.style.display = 'block';
                coverageSection.style.display = 'block';
                videoSection.style.display = 'block';
                descriptionSection.style.display = 'block';
                
                // Initialize map if not already initialized (for coverage areas)
                if (!map && coverageSection.style.display === 'block') {
                    initializeMap();
                }
            } else {
                amenitiesSection.style.display = 'none';
                coverageSection.style.display = 'none';
                videoSection.style.display = 'none';
                descriptionSection.style.display = 'none';
            }
        }

        // Setup document uploads
        function setupDocumentUploads() {
            // Roadworthy document
            const roadworthyUploadArea = document.getElementById('roadworthyUploadArea');
            const roadworthyFileInput = document.getElementById('roadworthyDocument');
            const roadworthyPreview = document.getElementById('roadworthyPreview');

            roadworthyUploadArea.addEventListener('click', () => roadworthyFileInput.click());
            roadworthyFileInput.addEventListener('change', (e) => {
                handleDocumentUpload(e.target.files[0], 'roadworthy');
            });

            roadworthyUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                roadworthyUploadArea.classList.add('dragover');
            });

            roadworthyUploadArea.addEventListener('dragleave', () => {
                roadworthyUploadArea.classList.remove('dragover');
            });

            roadworthyUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                roadworthyUploadArea.classList.remove('dragover');
                handleDocumentUpload(e.dataTransfer.files[0], 'roadworthy');
            });

            // Route permit document
            const routePermitUploadArea = document.getElementById('routePermitUploadArea');
            const routePermitFileInput = document.getElementById('routePermitDocument');
            const routePermitPreview = document.getElementById('routePermitPreview');

            routePermitUploadArea.addEventListener('click', () => routePermitFileInput.click());
            routePermitFileInput.addEventListener('change', (e) => {
                handleDocumentUpload(e.target.files[0], 'routePermit');
            });

            routePermitUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                routePermitUploadArea.classList.add('dragover');
            });

            routePermitUploadArea.addEventListener('dragleave', () => {
                routePermitUploadArea.classList.remove('dragover');
            });

            routePermitUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                routePermitUploadArea.classList.remove('dragover');
                handleDocumentUpload(e.dataTransfer.files[0], 'routePermit');
            });
        }

        // Handle document upload
        function handleDocumentUpload(file, type) {
            if (!file) return;
            
            // Check if it's PDF or image
            const isPDF = file.type === 'application/pdf';
            const isImage = file.type.startsWith('image/');
            
            if (!isPDF && !isImage) {
                alert('Please upload a PDF, JPG, JPEG, or PNG file.');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const documentData = {
                    file: file,
                    url: e.target.result,
                    name: file.name
                };
                
                if (type === 'roadworthy') {
                    roadworthyDocument = documentData;
                    displayDocumentPreview(documentData, 'roadworthyPreview');
                } else if (type === 'routePermit') {
                    routePermitDocument = documentData;
                    displayDocumentPreview(documentData, 'routePermitPreview');
                }
            };
            reader.readAsDataURL(file);
        }

        // Display document preview
        function displayDocumentPreview(documentData, previewId) {
            const preview = document.getElementById(previewId);
            const isPDF = documentData.file.type === 'application/pdf';
            
            if (isPDF) {
                preview.innerHTML = `
                    <div class="preview-item">
                        <div style="width: 100%; height: 150px; background: #f8f9fa; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 8px; padding: 1rem;">
                            <i class="fas fa-file-pdf" style="font-size: 3rem; color: #dc3545; margin-bottom: 0.5rem;"></i>
                            <div style="font-weight: 600; color: #333; text-align: center; word-break: break-word;">${documentData.name}</div>
                            <div style="font-size: 0.8rem; color: #6c757d; margin-top: 0.25rem;">${(documentData.file.size / (1024 * 1024)).toFixed(2)} MB</div>
                        </div>
                        <button class="preview-remove" onclick="removeDocument('${previewId.replace('Preview', '')}')">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
            } else {
                preview.innerHTML = `
                    <div class="preview-item">
                        <img src="${documentData.url}" alt="${documentData.name}" style="width: 100%; height: 150px; object-fit: contain; background: #f8f9fa;">
                        <button class="preview-remove" onclick="removeDocument('${previewId.replace('Preview', '')}')">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                `;
            }
        }

        // Remove document
        function removeDocument(type) {
            if (type === 'roadworthy') {
                roadworthyDocument = null;
                document.getElementById('roadworthyPreview').innerHTML = '';
                document.getElementById('roadworthyDocument').value = '';
            } else if (type === 'routePermit') {
                routePermitDocument = null;
                document.getElementById('routePermitPreview').innerHTML = '';
                document.getElementById('routePermitDocument').value = '';
            }
        }

        // Initialize map for coverage areas (only for private taxis)
        function initializeMap() {
            const coverageSection = document.getElementById('coverageSection');
            if (!coverageSection || coverageSection.style.display === 'none') {
                return; // Don't initialize if coverage section is hidden
            }
            
            if (map) {
                return; // Already initialized
            }
            
            map = new mapboxgl.Map({
                container: 'coverageMap',
                style: 'mapbox://styles/mapbox/streets-v12',
                center: [-26.2041, 28.0473], // Johannesburg
                zoom: 10
            });
            
            map.on('load', function() {
                // Add coverage area visualization
                addCoverageVisualization();
            });
        }

        // Add coverage area visualization
        function addCoverageVisualization() {
            // Example coverage areas
            const areas = [
                { name: 'Johannesburg CBD', center: [-26.2041, 28.0473], radius: 5 },
                { name: 'Soweto', center: [-26.2485, 27.9083], radius: 8 },
                { name: 'Sandton', center: [-26.1076, 28.0567], radius: 6 },
                { name: 'Pretoria', center: [-25.7479, 28.2293], radius: 7 }
            ];
            
            areas.forEach(area => {
                // Add circle for coverage area
                map.addSource(`coverage-${area.name}`, {
                    type: 'geojson',
                    data: {
                        type: 'Feature',
                        geometry: {
                            type: 'Point',
                            coordinates: area.center
                        }
                    }
                });
                
                map.addLayer({
                    id: `coverage-${area.name}`,
                    type: 'circle',
                    source: `coverage-${area.name}`,
                    paint: {
                        'circle-radius': area.radius * 1000, // Convert km to meters
                        'circle-color': '#01386A',
                        'circle-opacity': 0.2,
                        'circle-stroke-color': '#01386A',
                        'circle-stroke-width': 2
                    }
                });
            });
        }

        // Setup image upload
        function setupImageUpload() {
            // Main image upload
            const mainUploadArea = document.getElementById('mainImageUploadArea');
            const mainFileInput = document.getElementById('mainVehicleImage');
            const mainPreview = document.getElementById('mainImagePreview');

            mainUploadArea.addEventListener('click', () => mainFileInput.click());
            mainFileInput.addEventListener('change', (e) => {
                handleMainImage(e.target.files[0]);
            });

            // Additional images upload
            const uploadArea = document.getElementById('imageUploadArea');
            const fileInput = document.getElementById('vehicleImages');
            const preview = document.getElementById('imagePreview');

            uploadArea.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', (e) => {
                handleFiles(e.target.files);
            });

            // Video upload (only if video section is visible)
            const videoUploadArea = document.getElementById('videoUploadArea');
            if (videoUploadArea) {
                const videoFileInput = document.getElementById('vehicleVideo');
                const videoPreview = document.getElementById('videoPreview');

                videoUploadArea.addEventListener('click', () => videoFileInput.click());
                videoFileInput.addEventListener('change', (e) => {
                    handleVideo(e.target.files[0]);
                });

                videoUploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    videoUploadArea.classList.add('dragover');
                });

                videoUploadArea.addEventListener('dragleave', () => {
                    videoUploadArea.classList.remove('dragover');
                });

                videoUploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    videoUploadArea.classList.remove('dragover');
                    handleVideo(e.dataTransfer.files[0]);
                });
            }

            // Drag and drop for image areas
            [mainUploadArea, uploadArea].forEach(area => {
                area.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    area.classList.add('dragover');
                });

                area.addEventListener('dragleave', () => {
                    area.classList.remove('dragover');
                });

                area.addEventListener('drop', (e) => {
                    e.preventDefault();
                    area.classList.remove('dragover');
                    if (area === mainUploadArea) {
                        handleMainImage(e.dataTransfer.files[0]);
                    } else {
                        handleFiles(e.dataTransfer.files);
                    }
                });
            });
        }

        // Handle main image upload
        function handleMainImage(file) {
            if (file && file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageData = {
                        file: file,
                        url: e.target.result,
                        isMain: true
                    };
                    mainImage = imageData;
                    displayMainImagePreview(imageData);
                };
                reader.readAsDataURL(file);
            }
        }

        // Handle video upload
        function handleVideo(file) {
            if (file && file.type.startsWith('video/')) {
                // Check file size (50MB limit)
                if (file.size > 50 * 1024 * 1024) {
                    alert('Video file is too large. Please choose a file smaller than 50MB.');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    const videoData = {
                        file: file,
                        url: e.target.result
                    };
                    uploadedVideo = videoData;
                    displayVideoPreview(videoData);
                };
                reader.readAsDataURL(file);
            }
        }

        // Handle uploaded files
        function handleFiles(files) {
            Array.from(files).forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const imageData = {
                            file: file,
                            url: e.target.result
                        };
                        uploadedImages.push(imageData);
                        displayImagePreview(imageData);
                    };
                    reader.readAsDataURL(file);
                }
            });
        }

        // Display main image preview
        function displayMainImagePreview(imageData) {
            const preview = document.getElementById('mainImagePreview');
            preview.innerHTML = `
                <div class="preview-item">
                    <img src="${imageData.url}" alt="Main vehicle image">
                    <button class="preview-remove" onclick="removeMainImage()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
        }

        // Display video preview
        function displayVideoPreview(videoData) {
            const preview = document.getElementById('videoPreview');
            const fileSize = (videoData.file.size / (1024 * 1024)).toFixed(2);
            preview.innerHTML = `
                <div class="video-preview-item">
                    <video controls>
                        <source src="${videoData.url}" type="${videoData.file.type}">
                        Your browser does not support the video tag.
                    </video>
                    <div class="video-info">
                        <div class="video-name">${videoData.file.name}</div>
                        <div class="video-size">${fileSize} MB</div>
                    </div>
                    <button class="preview-remove" onclick="removeVideo()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
        }

        // Display image preview
        function displayImagePreview(imageData) {
            const preview = document.getElementById('imagePreview');
            const previewItem = document.createElement('div');
            previewItem.className = 'preview-item';
            previewItem.innerHTML = `
                <img src="${imageData.url}" alt="Vehicle image">
                <button class="preview-remove" onclick="removeImage(this)">
                    <i class="fas fa-times"></i>
                </button>
            `;
            preview.appendChild(previewItem);
        }

        // Remove main image
        function removeMainImage() {
            mainImage = null;
            document.getElementById('mainImagePreview').innerHTML = '';
        }

        // Remove video
        function removeVideo() {
            uploadedVideo = null;
            document.getElementById('videoPreview').innerHTML = '';
        }

        // Remove image
        function removeImage(button) {
            const previewItem = button.closest('.preview-item');
            const index = Array.from(document.querySelectorAll('.preview-item')).indexOf(previewItem);
            uploadedImages.splice(index, 1);
            previewItem.remove();
        }

        // Setup form validation
        function setupFormValidation() {
            const form = document.getElementById('vehiclePostForm');
            
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (validateForm()) {
                    submitVehicle();
                }
            });
        }

        // Load drivers from localStorage
        function loadDrivers() {
            const drivers = JSON.parse(localStorage.getItem('ownerDrivers') || '[]');
            const driverSelect = document.getElementById('selectedDriver');
            
            if (!driverSelect) return;
            
            // Clear existing options except the first one
            driverSelect.innerHTML = '<option value="">-- Select a driver --</option>';
            
            if (drivers.length === 0) {
                const option = document.createElement('option');
                option.value = '';
                option.textContent = 'No drivers available. Please add a driver first.';
                option.disabled = true;
                driverSelect.appendChild(option);
                return;
            }
            
            // Populate dropdown with active drivers
            drivers.filter(driver => driver.status === 'active').forEach(driver => {
                const option = document.createElement('option');
                option.value = driver.id;
                option.textContent = `${driver.firstName} ${driver.surname} - ${driver.phone} (License: ${driver.licenseClass})`;
                option.setAttribute('data-driver', JSON.stringify(driver));
                driverSelect.appendChild(option);
            });
            
            // Add event listener to show driver info when selected
            driverSelect.addEventListener('change', function() {
                const selectedDriverId = this.value;
                if (selectedDriverId) {
                    const selectedDriver = drivers.find(d => d.id === selectedDriverId);
                    if (selectedDriver) {
                        showDriverInfo(selectedDriver);
                    }
                } else {
                    hideDriverInfo();
                }
            });
        }

        // Show driver information preview
        function showDriverInfo(driver) {
            const preview = document.getElementById('driverInfoPreview');
            const content = document.getElementById('driverPreviewContent');
            
            if (!preview || !content) return;
            
            content.innerHTML = `
                <div class="form-group">
                    <label style="font-weight: 600; color: #6c757d;">Name</label>
                    <div style="padding: 0.5rem; background: white; border-radius: 8px; color: #333;">
                        ${escapeHtml(driver.firstName)} ${escapeHtml(driver.surname)}
                    </div>
                </div>
                <div class="form-group">
                    <label style="font-weight: 600; color: #6c757d;">Phone</label>
                    <div style="padding: 0.5rem; background: white; border-radius: 8px; color: #333;">
                        <i class="fas fa-phone"></i> ${escapeHtml(driver.phone)}
                    </div>
                </div>
                <div class="form-group">
                    <label style="font-weight: 600; color: #6c757d;">Email</label>
                    <div style="padding: 0.5rem; background: white; border-radius: 8px; color: #333;">
                        <i class="fas fa-envelope"></i> ${escapeHtml(driver.email || 'N/A')}
                    </div>
                </div>
                <div class="form-group">
                    <label style="font-weight: 600; color: #6c757d;">License</label>
                    <div style="padding: 0.5rem; background: white; border-radius: 8px; color: #333;">
                        <i class="fas fa-id-badge"></i> ${escapeHtml(driver.licenseNumber)} (${escapeHtml(driver.licenseClass)})
                    </div>
                </div>
                <div class="form-group">
                    <label style="font-weight: 600; color: #6c757d;">Experience</label>
                    <div style="padding: 0.5rem; background: white; border-radius: 8px; color: #333;">
                        <i class="fas fa-clock"></i> ${driver.experienceYears} years
                    </div>
                </div>
            `;
            
            preview.style.display = 'block';
        }

        // Hide driver information preview
        function hideDriverInfo() {
            const preview = document.getElementById('driverInfoPreview');
            if (preview) {
                preview.style.display = 'none';
            }
        }

        // Setup "Other" option handlers for make, model, color
        function setupOtherOptions() {
            // Make "Other" handler
            const makeSelect = document.getElementById('vehicleMake');
            const makeOtherInput = document.getElementById('vehicleMakeOther');
            if (makeSelect && makeOtherInput) {
                makeSelect.addEventListener('change', function() {
                    if (this.value === 'Other') {
                        makeOtherInput.style.display = 'block';
                        makeOtherInput.required = true;
                    } else {
                        makeOtherInput.style.display = 'none';
                        makeOtherInput.required = false;
                        makeOtherInput.value = '';
                    }
                });
            }
            
            // Model "Other" handler
            const modelSelect = document.getElementById('vehicleModel');
            const modelOtherInput = document.getElementById('vehicleModelOther');
            if (modelSelect && modelOtherInput) {
                modelSelect.addEventListener('change', function() {
                    if (this.value === 'Other') {
                        modelOtherInput.style.display = 'block';
                        modelOtherInput.required = true;
                    } else {
                        modelOtherInput.style.display = 'none';
                        modelOtherInput.required = false;
                        modelOtherInput.value = '';
                    }
                });
            }
            
            // Color "Other" handler
            const colorSelect = document.getElementById('vehicleColor');
            const colorOtherInput = document.getElementById('vehicleColorOther');
            if (colorSelect && colorOtherInput) {
                colorSelect.addEventListener('change', function() {
                    if (this.value === 'Other') {
                        colorOtherInput.style.display = 'block';
                        colorOtherInput.required = true;
                    } else {
                        colorOtherInput.style.display = 'none';
                        colorOtherInput.required = false;
                        colorOtherInput.value = '';
                    }
                });
            }
        }
        
        // Get vehicle make value (handles "Other" option)
        function getVehicleMake() {
            const makeSelect = document.getElementById('vehicleMake');
            if (!makeSelect) return '';
            return makeSelect.value === 'Other' 
                ? document.getElementById('vehicleMakeOther').value.trim() 
                : makeSelect.value;
        }
        
        // Get vehicle model value (handles "Other" option)
        function getVehicleModel() {
            const modelSelect = document.getElementById('vehicleModel');
            if (!modelSelect) return '';
            return modelSelect.value === 'Other' 
                ? document.getElementById('vehicleModelOther').value.trim() 
                : modelSelect.value;
        }
        
        // Get vehicle color value (handles "Other" option)
        function getVehicleColor() {
            const colorSelect = document.getElementById('vehicleColor');
            if (!colorSelect) return '';
            return colorSelect.value === 'Other' 
                ? document.getElementById('vehicleColorOther').value.trim() 
                : colorSelect.value;
        }

        // Validate form
        function validateForm() {
            const requiredFields = ['vehicleMake', 'vehicleModel', 'vehicleColor', 'vehicleType', 'registration', 'licensePlate', 'capacity', 'selectedDriver'];
            let isValid = true;

            const selectedTaxiType = document.querySelector('input[name="taxiServiceType"]:checked')?.value;
            const isPrivate = document.getElementById('isPrivateTaxi').checked;
            
            // Validate that either a service type is selected OR private is checked
            if (!selectedTaxiType && !isPrivate) {
                alert('Please select a taxi service type (Long-distance or Local) or check Private Taxi.');
                isValid = false;
            }

            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field && !field.value.trim()) {
                    field.style.borderColor = '#dc3545';
                    isValid = false;
                } else if (field) {
                    field.style.borderColor = '#e9ecef';
                }
            });
            
            // Validate "Other" inputs if selected
            const makeSelect = document.getElementById('vehicleMake');
            if (makeSelect && makeSelect.value === 'Other') {
                const makeOther = document.getElementById('vehicleMakeOther');
                if (!makeOther || !makeOther.value.trim()) {
                    makeOther.style.borderColor = '#dc3545';
                    isValid = false;
                } else {
                    makeOther.style.borderColor = '#e9ecef';
                }
            }
            
            const modelSelect = document.getElementById('vehicleModel');
            if (modelSelect && modelSelect.value === 'Other') {
                const modelOther = document.getElementById('vehicleModelOther');
                if (!modelOther || !modelOther.value.trim()) {
                    modelOther.style.borderColor = '#dc3545';
                    isValid = false;
                } else {
                    modelOther.style.borderColor = '#e9ecef';
                }
            }
            
            const colorSelect = document.getElementById('vehicleColor');
            if (colorSelect && colorSelect.value === 'Other') {
                const colorOther = document.getElementById('vehicleColorOther');
                if (!colorOther || !colorOther.value.trim()) {
                    colorOther.style.borderColor = '#dc3545';
                    isValid = false;
                } else {
                    colorOther.style.borderColor = '#e9ecef';
                }
            }

            // Validate roadworthy document
            if (!roadworthyDocument) {
                alert('Please upload a roadworthy certificate.');
                isValid = false;
            }

            // Validate route selection for long-distance/local
            if (selectedTaxiType === 'long-distance') {
                const longDistanceRoute = document.querySelector('input[name="longDistanceRoute"]:checked');
                if (!longDistanceRoute) {
                    alert('Please select your long-distance route.');
                    isValid = false;
                }
            } else if (selectedTaxiType === 'local') {
                const localRouteCheckboxes = document.querySelectorAll('input[name="localRoutes"]:checked');
                if (localRouteCheckboxes.length === 0) {
                    alert('Please select at least one local operating area.');
                    isValid = false;
                }
            }

            // Validate route permit only for long-distance/local (not required for private-only)
            if ((selectedTaxiType === 'long-distance' || selectedTaxiType === 'local') && !routePermitDocument) {
                alert('Please upload a route permit document.');
                isValid = false;
            }

            // Validate coverage areas for private taxis (when private is checked OR when no service type is selected)
            if (isPrivate || !selectedTaxiType || selectedTaxiType === '') {
                const coverageCheckboxes = document.querySelectorAll('input[type="checkbox"][id^="jhb_"], input[type="checkbox"][id^="soweto"], input[type="checkbox"][id^="sandton"], input[type="checkbox"][id^="pretoria"], input[type="checkbox"][id^="centurion"], input[type="checkbox"][id^="midrand"], input[type="checkbox"][id^="randburg"], input[type="checkbox"][id^="roodepoort"]');
                const coverageSelected = Array.from(coverageCheckboxes).some(cb => cb.checked);
                
                if (!coverageSelected) {
                    alert('Please select at least one coverage area.');
                    isValid = false;
                }
            }

            return isValid;
        }

        // Show review section
        function submitVehicle() {
            const selectedTaxiType = document.querySelector('input[name="taxiServiceType"]:checked')?.value;
            const isPrivate = document.getElementById('isPrivateTaxi').checked;
            
            // Get route selection
            let selectedRoute = null;
            if (selectedTaxiType === 'long-distance') {
                const longDistanceRoute = document.querySelector('input[name="longDistanceRoute"]:checked');
                selectedRoute = longDistanceRoute ? longDistanceRoute.value : null;
            } else if (selectedTaxiType === 'local') {
                const localRoutes = Array.from(document.querySelectorAll('input[name="localRoutes"]:checked')).map(cb => cb.value);
                selectedRoute = localRoutes.length > 0 ? localRoutes : null;
            }
            
            const selectedDriverId = document.getElementById('selectedDriver').value;
            const drivers = JSON.parse(localStorage.getItem('ownerDrivers') || '[]');
            const selectedDriver = selectedDriverId ? drivers.find(d => d.id === selectedDriverId) : null;
            
            const formData = {
                make: getVehicleMake(),
                model: getVehicleModel(),
                color: getVehicleColor(),
                vehicleType: document.getElementById('vehicleType').value,
                registration: document.getElementById('registration').value,
                licensePlate: document.getElementById('licensePlate').value,
                capacity: document.getElementById('capacity').value,
                taxiServiceType: selectedTaxiType,
                selectedRoute: selectedRoute,
                isPrivateTaxi: isPrivate,
                amenities: isPrivate ? getSelectedAmenities() : [],
                coverageAreas: isPrivate ? getSelectedCoverageAreas() : [],
                maxDistance: isPrivate ? (document.getElementById('maxDistance')?.value || '') : '',
                description: isPrivate ? (document.getElementById('description')?.value || '') : '',
                selectedDriverId: selectedDriverId,
                selectedDriver: selectedDriver,
                mainImage: mainImage,
                images: uploadedImages,
                video: isPrivate ? uploadedVideo : null,
                roadworthyDocument: roadworthyDocument,
                routePermitDocument: routePermitDocument
            };

            // Store form data temporarily for review
            window.tempFormData = formData;

            // Hide form and show review section
            document.getElementById('vehiclePostForm').style.display = 'none';
            document.getElementById('reviewSection').style.display = 'block';
            document.getElementById('step2').classList.add('active');
            
            // Populate review sections
            populateReview(formData);
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Populate review section with form data
        function populateReview(formData) {
            // Vehicle Information
            const vehicleInfoHTML = `
                <div class="review-item">
                    <div class="review-item-label">Make</div>
                    <div class="review-item-value">${escapeHtml(formData.make)}</div>
                </div>
                <div class="review-item">
                    <div class="review-item-label">Model</div>
                    <div class="review-item-value">${escapeHtml(formData.model)}</div>
                </div>
                <div class="review-item">
                    <div class="review-item-label">Color</div>
                    <div class="review-item-value">${escapeHtml(formData.color)}</div>
                </div>
                <div class="review-item">
                    <div class="review-item-label">Vehicle Type</div>
                    <div class="review-item-value">${escapeHtml(formData.vehicleType)}</div>
                </div>
                <div class="review-item">
                    <div class="review-item-label">Registration Number</div>
                    <div class="review-item-value">${escapeHtml(formData.registration)}</div>
                </div>
                <div class="review-item">
                    <div class="review-item-label">License Plate</div>
                    <div class="review-item-value">${escapeHtml(formData.licensePlate)}</div>
                </div>
                <div class="review-item">
                    <div class="review-item-label">Seating Capacity</div>
                    <div class="review-item-value">${escapeHtml(formData.capacity)} seats</div>
                </div>
            `;
            document.getElementById('reviewVehicleInfo').innerHTML = vehicleInfoHTML;

            // Service Type & Routes
            if (formData.taxiServiceType || formData.isPrivateTaxi) {
                let serviceTypeHTML = '';
                if (formData.taxiServiceType === 'long-distance') {
                    serviceTypeHTML = `
                        <div class="review-item">
                            <div class="review-item-label">Service Type</div>
                            <div class="review-item-value"><i class="fas fa-route"></i> Long-distance Taxi</div>
                        </div>
                        <div class="review-item">
                            <div class="review-item-label">Route</div>
                            <div class="review-item-value">${formatRoute(formData.selectedRoute)}</div>
                        </div>
                    `;
                } else if (formData.taxiServiceType === 'local') {
                    serviceTypeHTML = `
                        <div class="review-item">
                            <div class="review-item-label">Service Type</div>
                            <div class="review-item-value"><i class="fas fa-map-marker-alt"></i> Local Taxi</div>
                        </div>
                        <div class="review-item">
                            <div class="review-item-label">Operating Areas</div>
                            <div class="review-item-value">${Array.isArray(formData.selectedRoute) ? formData.selectedRoute.join(', ') : formData.selectedRoute}</div>
                        </div>
                    `;
                }
                
                if (formData.isPrivateTaxi) {
                    serviceTypeHTML += `
                        <div class="review-item">
                            <div class="review-item-label">Also Available As</div>
                            <div class="review-item-value"><i class="fas fa-key"></i> Private Taxi</div>
                        </div>
                    `;
                    if (formData.coverageAreas && formData.coverageAreas.length > 0) {
                        serviceTypeHTML += `
                            <div class="review-item">
                                <div class="review-item-label">Coverage Areas</div>
                                <div class="review-item-value">${formData.coverageAreas.join(', ')}</div>
                            </div>
                        `;
                    }
                    if (formData.maxDistance) {
                        serviceTypeHTML += `
                            <div class="review-item">
                                <div class="review-item-label">Maximum Distance</div>
                                <div class="review-item-value">${formData.maxDistance} km</div>
                            </div>
                        `;
                    }
                }

                document.getElementById('reviewTaxiType').innerHTML = serviceTypeHTML;
                document.getElementById('reviewTaxiTypeCard').style.display = 'block';
            }

            // Driver Information
            let contactHTML = '';
            if (formData.selectedDriver) {
                const driver = formData.selectedDriver;
                contactHTML = `
                    <div class="review-item">
                        <div class="review-item-label">Driver Name</div>
                        <div class="review-item-value"><i class="fas fa-user-tie"></i> ${escapeHtml(driver.firstName)} ${escapeHtml(driver.surname)}</div>
                    </div>
                    <div class="review-item">
                        <div class="review-item-label">Phone Number</div>
                        <div class="review-item-value"><i class="fas fa-phone"></i> ${escapeHtml(driver.phone)}</div>
                    </div>
                    ${driver.email ? `
                    <div class="review-item">
                        <div class="review-item-label">Email Address</div>
                        <div class="review-item-value"><i class="fas fa-envelope"></i> ${escapeHtml(driver.email)}</div>
                    </div>
                    ` : ''}
                    <div class="review-item">
                        <div class="review-item-label">License</div>
                        <div class="review-item-value"><i class="fas fa-id-badge"></i> ${escapeHtml(driver.licenseNumber)} (${escapeHtml(driver.licenseClass)})</div>
                    </div>
                    <div class="review-item">
                        <div class="review-item-label">Experience</div>
                        <div class="review-item-value"><i class="fas fa-clock"></i> ${driver.experienceYears} years</div>
                    </div>
                `;
            } else {
                contactHTML = `
                    <div class="review-item">
                        <div class="review-item-value" style="color: #dc3545;"><i class="fas fa-exclamation-triangle"></i> No driver selected</div>
                    </div>
                `;
            }
            document.getElementById('reviewContact').innerHTML = contactHTML;

            // Documents
            const documentsHTML = `
                <div class="review-item">
                    <div class="review-item-label">Roadworthy Certificate</div>
                    <div class="review-item-value"><i class="fas fa-check-circle" style="color: #28a745;"></i> ${formData.roadworthyDocument ? 'Uploaded' : 'Not uploaded'}</div>
                </div>
                ${formData.routePermitDocument ? `
                <div class="review-item">
                    <div class="review-item-label">Route Permit</div>
                    <div class="review-item-value"><i class="fas fa-check-circle" style="color: #28a745;"></i> Uploaded</div>
                </div>
                ` : ''}
                ${formData.mainImage ? `
                <div class="review-item">
                    <div class="review-item-label">Main Image</div>
                    <div class="review-item-value"><i class="fas fa-check-circle" style="color: #28a745;"></i> Uploaded</div>
                </div>
                ` : ''}
                ${formData.images && formData.images.length > 0 ? `
                <div class="review-item">
                    <div class="review-item-label">Additional Images</div>
                    <div class="review-item-value"><i class="fas fa-check-circle" style="color: #28a745;"></i> ${formData.images.length} image(s) uploaded</div>
                </div>
                ` : ''}
            `;
            document.getElementById('reviewDocuments').innerHTML = documentsHTML;
        }

        // Format route for display
        function formatRoute(route) {
            if (!route) return 'N/A';
            const routeMap = {
                'pretoria-tzaneen': 'Pretoria ↔ Tzaneen',
                'jhb-tzaneen': 'Johannesburg ↔ Tzaneen'
            };
            return routeMap[route] || route;
        }

        // Escape HTML to prevent XSS
        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return String(text).replace(/[&<>"']/g, m => map[m]);
        }

        // Go back to form
        function goBackToForm() {
            document.getElementById('reviewSection').style.display = 'none';
            document.getElementById('vehiclePostForm').style.display = 'block';
            document.getElementById('step2').classList.remove('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Confirm submission
        function confirmSubmission() {
            if (!window.tempFormData) {
                alert('Error: Form data not found. Please try again.');
                return;
            }

            // Add status and timestamp
            const vehicleData = {
                ...window.tempFormData,
                id: Date.now().toString(), // Simple ID generation
                status: 'pending',
                submittedAt: new Date().toISOString(),
                submittedDate: new Date().toLocaleDateString(),
                submittedTime: new Date().toLocaleTimeString()
            };

            // Save to localStorage (in real app, this would go to backend)
            let vehicles = JSON.parse(localStorage.getItem('ownerVehicles') || '[]');
            vehicles.push(vehicleData);
            localStorage.setItem('ownerVehicles', JSON.stringify(vehicles));

            console.log('Vehicle submitted:', vehicleData);

            // Hide review section and show success message
            document.getElementById('reviewSection').style.display = 'none';
            document.getElementById('successMessage').style.display = 'block';
            document.getElementById('step2').classList.remove('active');
            document.getElementById('step2').classList.add('completed');
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Clear temp data
            window.tempFormData = null;
        }

        // Go to dashboard
        function goToDashboard() {
            window.location.href = 'owner-dashboard.html';
        }

        // Get selected amenities
        function getSelectedAmenities() {
            const amenities = [];
            document.querySelectorAll('input[type="checkbox"][id^="ac"], input[type="checkbox"][id^="music"], input[type="checkbox"][id^="wifi"], input[type="checkbox"][id^="charging"], input[type="checkbox"][id^="luggage"], input[type="checkbox"][id^="wheelchair"]').forEach(cb => {
                if (cb.checked) {
                    amenities.push(cb.value);
                }
            });
            return amenities;
        }

        // Get selected coverage areas
        function getSelectedCoverageAreas() {
            const areas = [];
            document.querySelectorAll('input[type="checkbox"][id^="jhb_"], input[type="checkbox"][id^="soweto"], input[type="checkbox"][id^="sandton"], input[type="checkbox"][id^="pretoria"], input[type="checkbox"][id^="centurion"], input[type="checkbox"][id^="midrand"], input[type="checkbox"][id^="randburg"], input[type="checkbox"][id^="roodepoort"]').forEach(cb => {
                if (cb.checked) {
                    areas.push(cb.value);
                }
            });
            return areas;
        }

        // Save as draft
        function saveDraft() {
            const selectedTaxiType = document.querySelector('input[name="taxiServiceType"]:checked')?.value;
            const isPrivate = document.getElementById('isPrivateTaxi').checked;
            
            // Get route selection
            let selectedRoute = null;
            if (selectedTaxiType === 'long-distance') {
                const longDistanceRoute = document.querySelector('input[name="longDistanceRoute"]:checked');
                selectedRoute = longDistanceRoute ? longDistanceRoute.value : null;
            } else if (selectedTaxiType === 'local') {
                const localRoutes = Array.from(document.querySelectorAll('input[name="localRoutes"]:checked')).map(cb => cb.value);
                selectedRoute = localRoutes.length > 0 ? localRoutes : null;
            }
            
            const formData = {
                make: getVehicleMake(),
                model: getVehicleModel(),
                color: getVehicleColor(),
                vehicleType: document.getElementById('vehicleType').value,
                registration: document.getElementById('registration').value,
                licensePlate: document.getElementById('licensePlate').value,
                capacity: document.getElementById('capacity').value,
                taxiServiceType: selectedTaxiType,
                selectedRoute: selectedRoute,
                isPrivateTaxi: isPrivate,
                amenities: isPrivate ? getSelectedAmenities() : [],
                coverageAreas: isPrivate ? getSelectedCoverageAreas() : [],
                maxDistance: isPrivate ? (document.getElementById('maxDistance')?.value || '') : '',
                description: isPrivate ? (document.getElementById('description')?.value || '') : '',
                ownerName: document.getElementById('ownerName').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                email: document.getElementById('email').value,
                whatsapp: document.getElementById('whatsapp').value,
                images: uploadedImages,
                video: isPrivate ? uploadedVideo : null,
                roadworthyDocument: roadworthyDocument,
                routePermitDocument: routePermitDocument,
                status: 'draft'
            };

            // In real app, save to backend
            console.log('Draft saved:', formData);
            alert('Draft saved successfully!');
        }

        // Mobile menu toggle function
        function toggleMobileMenu() {
            const menu = document.getElementById("mobileMenu");
            const isShown = menu.classList.toggle("show");

            if (isShown) {
                topNavZIndexIncrease();
            } else {
                topNavZIndexDecrease();
            }
        }

        function topNavZIndexIncrease() {
            const navbar = document.querySelector(".topnav");
            if (navbar) {
                navbar.style.zIndex = "3001";
            }
        }

        function topNavZIndexDecrease() {
            const navbar = document.querySelector(".topnav");
            if (navbar) {
                navbar.style.zIndex = "3";
            }
        }
    </script>

    <script type="module">
        // Check authentication status and update navigation
        document.addEventListener('DOMContentLoaded', function() {
            const authButtons = document.getElementById('authButtons');
            const fullNav = document.getElementById('fullNav');
            
            // Check if user is logged in
            const isLoggedIn = localStorage.getItem('userProfile') || sessionStorage.getItem('userProfile');
            
            if (isLoggedIn) {
                // User is logged in - show full navigation
                if (authButtons) authButtons.style.display = 'none';
                if (fullNav) fullNav.style.display = 'flex';
            } else {
                // User is not logged in - show auth buttons
                if (authButtons) authButtons.style.display = 'flex';
                if (fullNav) fullNav.style.display = 'none';
            }
        });
    </script>
    
    <script type="module" src="../../js/authentication/logout.js"></script>
</body>
</html>
